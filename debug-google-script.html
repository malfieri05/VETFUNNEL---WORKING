<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Google Apps Script</title>
</head>
<body>
    <h1>Debug Google Apps Script Data Submission</h1>
    
    <div id="results"></div>
    
    <script>
        // Test the Google Apps Script with sample data
        async function testGoogleScript() {
            const resultsDiv = document.getElementById('results');
            
            // Sample form data that should be captured
            const testFormData = {
                state: 'CA',
                militaryStatus: 'Veteran',
                branchOfService: 'Army',
                maritalStatus: 'Married',
                coverageAmount: '$100,000',
                contactInfo: {
                    firstName: 'John',
                    lastName: 'Doe',
                    email: 'john.doe@example.com',
                    phone: '(555) 123-4567',
                    dateOfBirth: '1980-01-01'
                },
                medicalAnswers: {
                    tobaccoUse: 'No',
                    medicalConditions: ['None'],
                    height: "5'10\"",
                    weight: '180',
                    hospitalCare: 'No',
                    diabetesMedication: 'No'
                },
                applicationData: {
                    address: {
                        street: '123 Test St',
                        city: 'Test City',
                        state: 'CA',
                        zipCode: '90210'
                    },
                    beneficiary: {
                        name: 'Jane Doe',
                        relationship: 'Spouse'
                    },
                    vaInfo: {
                        vaNumber: '123456789',
                        serviceConnected: 'Yes'
                    },
                    ssn: '123-45-6789',
                    banking: {
                        bankName: 'Test Bank',
                        routingNumber: '123456789',
                        accountNumber: '987654321'
                    },
                    policyDate: '2024-01-01',
                    quoteData: {
                        coverageAmount: 100000,
                        monthlyPremium: 150,
                        userAge: 44,
                        userGender: 'Male',
                        quoteType: 'IUL'
                    }
                }
            };
            
            // Test different form types
            const tests = [
                {
                    name: 'Partial Submission',
                    formType: 'Partial',
                    currentStep: 1,
                    stepName: 'State Selection'
                },
                {
                    name: 'Lead Partial Submission',
                    formType: 'LeadPartial',
                    currentStep: 11,
                    stepName: 'Diabetes Medication'
                },
                {
                    name: 'Lead Submission',
                    formType: 'Lead'
                },
                {
                    name: 'Application Submission',
                    formType: 'Application'
                }
            ];
            
            for (const test of tests) {
                try {
                    resultsDiv.innerHTML += `<h3>Testing: ${test.name}</h3>`;
                    
                    const formDataParams = new URLSearchParams();
                    formDataParams.append('formType', test.formType);
                    formDataParams.append('sessionId', 'test_session_' + Date.now());
                    formDataParams.append('formData', JSON.stringify(testFormData));
                    
                    if (test.currentStep) {
                        formDataParams.append('currentStep', test.currentStep.toString());
                    }
                    if (test.stepName) {
                        formDataParams.append('stepName', test.stepName);
                    }
                    
                    formDataParams.append('userAgent', navigator.userAgent);
                    formDataParams.append('referrer', document.referrer);
                    
                    const response = await fetch('https://script.google.com/macros/s/AKfycbw4-9ngPEZ252AP8mTsaGtLrNQoaerl_qc82vtGkkpsNq0AiwqAIHWe5Lfgx462LBtB/exec', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: formDataParams.toString()
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const result = await response.json();
                    resultsDiv.innerHTML += `<p style="color: green;">✅ Success: ${JSON.stringify(result)}</p>`;
                    
                } catch (error) {
                    resultsDiv.innerHTML += `<p style="color: red;">❌ Error: ${error.message}</p>`;
                }
                
                resultsDiv.innerHTML += '<hr>';
            }
        }
        
        // Run the test when page loads
        window.addEventListener('load', testGoogleScript);
    </script>
</body>
</html> 